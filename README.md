# è¯¾ä»¶å†…å®¹æå–ä¸ä¼˜åŒ–å·¥å…· (PPT_Text_Extractor)

## ç®€ä»‹
é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº Python çš„æ™ºèƒ½å·¥å…·ï¼Œæ—¨åœ¨ä»å¤šç§ PPT æ–‡ä»¶ä¸­æå–æ–‡æœ¬å’Œå›¾ç‰‡å†…å®¹ï¼Œå¹¶é€šè¿‡ä¼˜åŒ–å¤„ç†ç”Ÿæˆè‡ªç„¶æµç•…çš„æ–‡æœ¬è¾“å‡ºã€‚åˆ©ç”¨ `python-pptx`ã€`win32com` å’Œ `PaddleOCR` æŠ€æœ¯ï¼Œæ”¯æŒå¹»ç¯ç‰‡æ–‡æœ¬æå–å’Œå›¾ç‰‡æ–‡å­—è¯†åˆ«ï¼Œé€‚ç”¨äºæ•™å­¦æ–‡æ¡£æ•´ç†æˆ–è‡ªåŠ¨åŒ–å¤„ç†ã€‚

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Build Status](https://img.shields.io/badge/build-passing-brightgreen.svg)
![Version](https://img.shields.io/badge/version-1.0.0-yellow.svg)

---

## åŠŸèƒ½ç‰¹ç‚¹
- ğŸ“„ **PPT æ–‡æœ¬æå–**ï¼šè‡ªåŠ¨æå–å¹»ç¯ç‰‡çš„æ ‡é¢˜ã€æ®µè½å’Œè¡¨æ ¼å†…å®¹ï¼Œæ”¯æŒ `.pptx` å’Œæ—§ç‰ˆæ ¼å¼ï¼ˆ`.ppt`ã€`.pot`ã€`.pps`ï¼‰ã€‚
- ğŸ–¼ï¸ **å›¾ç‰‡æ–‡æœ¬è¯†åˆ«**ï¼šä½¿ç”¨ PaddleOCR ä»å¹»ç¯ç‰‡å›¾ç‰‡ä¸­æå–æ–‡å­—ï¼Œæ”¯æŒå¤šç§ PowerPoint æ–‡ä»¶æ ¼å¼ã€‚
- âœï¸ **æ–‡æœ¬ä¼˜åŒ–**ï¼šå°†æå–çš„å†…å®¹ä¼˜åŒ–ä¸ºå™è¿°æ€§æ–‡æœ¬ï¼Œä¾¿äºé˜…è¯»æˆ–åç»­ä½¿ç”¨ã€‚
- ğŸ“‹ **ç»“æ„åŒ–è¾“å‡º**ï¼šæŒ‰å¹»ç¯ç‰‡åˆ†éš”ä¿å­˜æ–‡æœ¬å’Œå›¾ç‰‡å†…å®¹ã€‚
- âš™ï¸ **æ—¥å¿—è®°å½•**ï¼šæä¾›è¯¦ç»†çš„å¤„ç†æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•ã€‚
- ğŸŒ **Web æ”¯æŒ**ï¼šé€šè¿‡ Flask æä¾› Web æ¥å£ï¼Œå¯ä¸Šä¼ æ–‡ä»¶å¹¶è·å–ä¼˜åŒ–ç»“æœã€‚

---

## æŠ€æœ¯æ ˆ
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **python-pptx**: è§£æ `.pptx` æ–‡ä»¶
- **pywin32**: å¤„ç†æ—§ç‰ˆ PowerPoint æ–‡ä»¶ï¼ˆ`.ppt`ã€`.pot`ã€`.pps`ï¼‰
- **PaddleOCR**: å›¾ç‰‡æ–‡æœ¬è¯†åˆ«
- **Flask**: Web æœåŠ¡æ¡†æ¶
- **Spacy**: è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆæ–‡æœ¬ä¼˜åŒ–ï¼‰
- **Transformers**: AI æ–‡æœ¬ç”Ÿæˆï¼ˆä¼˜åŒ–è¡”æ¥ï¼‰
- **logging**: æ—¥å¿—è®°å½•

---

## å®‰è£…æ­¥éª¤

### å‰ç½®æ¡ä»¶
- Python 3.8 æˆ–ä»¥ä¸Šç‰ˆæœ¬
- Gitï¼ˆç”¨äºå…‹éš†ä»“åº“ï¼‰
- Windows ç³»ç»Ÿï¼ˆå› ä½¿ç”¨ `win32com`ï¼Œéœ€å®‰è£… Microsoft PowerPointï¼‰
- å¯é€‰ï¼šGPU æ”¯æŒï¼ˆåŠ é€Ÿ PaddleOCRï¼‰

### å®‰è£…ä¾èµ–
```bash
# 1. å…‹éš†é¡¹ç›®ä»“åº“
git clone https://github.com/blankboards/pptx_extraction.git
cd pptx_extraction

# 2. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python -m venv venv
# Unix/macOS
source venv/bin/activate
# Windows
venv\Scripts\activate

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### ä¾èµ–åˆ—è¡¨ (requirements.txt ç¤ºä¾‹)
```
python-pptx>=0.6.21
paddlepaddle>=2.5.0
paddleocr>=2.6.1
pywin32>=306
flask>=2.2.5
flask-cors>=4.0.0
python-dotenv>=1.0.0
spacy>=3.7.2
transformers>=4.35.2
protobuf==3.20.3
scikit-image>=0.21.0
```

### é¢å¤–æ­¥éª¤
- ä¸‹è½½ Spacy ä¸­æ–‡æ¨¡å‹ï¼š
```bash
python -m spacy download zh_core_web_sm
```

---

## å¿«é€Ÿå¼€å§‹

### å‘½ä»¤è¡Œä½¿ç”¨
ä»¥ä¸‹æ˜¯å¦‚ä½•æå–å’Œä¼˜åŒ– PPT å†…å®¹çš„ç¤ºä¾‹ï¼š
```python
from main import process_ppt_file

# æŒ‡å®š PPT æ–‡ä»¶è·¯å¾„
ppt_path = 'sample.ppt'  # æ”¯æŒ .ppt å’Œ .pptx

# å¤„ç† PPT å¹¶ç”Ÿæˆä¼˜åŒ–æ–‡æœ¬
process_ppt_file(ppt_path)
print("ä¼˜åŒ–æ–‡æœ¬å·²ä¿å­˜è‡³ output/optimized_output.txt")
```

### Web ä½¿ç”¨
1. è¿è¡Œ Web æœåŠ¡ï¼š
```bash
python app.py
```
2. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://localhost:5000/`ï¼Œä¸Šä¼  PPT æ–‡ä»¶è·å–ä¼˜åŒ–ç»“æœã€‚

### è¾“å‡ºç¤ºä¾‹
```
Title: N/A
Author: huawei

ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ç¬¬ 1 å¼ å¹»ç¯ç‰‡ï¼š
é¦–å…ˆæ˜¯ æ·±åº¦å­¦ä¹ åŸºç¡€ã€‚
è¿™é‡Œæœ‰ä¸ªé‡ç‚¹ æœ¬è¯¾ç¨‹å°†æ·±å…¥è®²è§£æ·±åº¦å­¦ä¹ çš„åŸºæœ¬åŸç†ã€‚
```

---

## é…ç½®å‚æ•°

### ä¸»å‡½æ•°å‚æ•°
| å‚æ•°å       | ç±»å‹  | é»˜è®¤å€¼        | æè¿°                     |
|--------------|-------|---------------|--------------------------|
| `file_path`  | `str` | å¿…å¡«          | PPT æ–‡ä»¶è·¯å¾„             |
| `output_dir` | `str` | `'output'`    | è¾“å‡ºç›®å½•ï¼ˆå®šä¹‰åœ¨ config.pyï¼‰ |

### å¯è°ƒæ•´é…ç½® (config.py)
- `OUTPUT_DIR`: è¾“å‡ºæ–‡æœ¬å’Œå›¾ç‰‡çš„ç›®å½•ï¼ˆå‘½ä»¤è¡Œæ¨¡å¼ï¼‰
- `OUTPUT_DIR_2`: Web æ¨¡å¼è¾“å‡ºç›®å½•
- `PPTX_FILE`: é»˜è®¤å¤„ç†çš„ PPT æ–‡ä»¶è·¯å¾„ï¼ˆå‘½ä»¤è¡Œæ¨¡å¼ï¼‰
- `PPTX_FILE_2`: å¤‡ç”¨ PPT æ–‡ä»¶è·¯å¾„

---

## é¡¹ç›®ç»“æ„
```
PPT_Text_Extractor/
â”œâ”€â”€ modules/                 # åŠŸèƒ½æ¨¡å—ç›®å½•
â”‚   â”œâ”€â”€ __init__.py          # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â”‚   â”œâ”€â”€ ppt_text_extraction.py  # PPT æ–‡æœ¬å’Œå…ƒæ•°æ®æå–æ¨¡å—
â”‚   â”œâ”€â”€ image_extraction_p.py   # å›¾ç‰‡æ–‡æœ¬æå–æ¨¡å—ï¼ˆPaddleOCRï¼‰
â”‚   â”œâ”€â”€ image_extraction_t.py   # Tesseract å›¾ç‰‡æ–‡æœ¬æå–ï¼ˆæœªä½¿ç”¨ï¼‰
â”‚   â”œâ”€â”€ ai_optimizer.py         # æ–‡æœ¬ä¼˜åŒ–æ¨¡å—
â”‚   â”œâ”€â”€ utils.py                # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ config.py               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ static/                  # Web é™æ€æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ index.html           # å‰ç«¯ç•Œé¢
â”œâ”€â”€ output/                  # è¾“å‡ºç›®å½•ç¤ºä¾‹ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ slide_1/             # å¹»ç¯ç‰‡ 1 çš„è¾“å‡º
â”‚   â”‚   â”œâ”€â”€ image/           # å›¾ç‰‡æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ image_1.jpg  # æå–çš„å›¾ç‰‡
â”‚   â”‚   â”‚   â””â”€â”€ slide_1_image_1_text.txt  # å›¾ç‰‡è¯†åˆ«æ–‡æœ¬
â”‚   â”‚   â””â”€â”€ slide_1_texts.txt  # å¹»ç¯ç‰‡æ–‡æœ¬
â”‚   â””â”€â”€ optimized_output.txt # ä¼˜åŒ–åçš„æ–‡æœ¬ï¼ˆå‘½ä»¤è¡Œæ¨¡å¼ï¼‰
â”œâ”€â”€ app.py                   # Web æœåŠ¡è„šæœ¬
â”œâ”€â”€ main.py                  # å‘½ä»¤è¡Œå…¥å£è„šæœ¬
â”œâ”€â”€ test.py                  # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ requirements.txt         # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆæ³¨æ„æ•æ„Ÿä¿¡æ¯ï¼‰
â”œâ”€â”€ .gitignore               # å¿½ç•¥æ–‡ä»¶é…ç½®
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

---

## ä½¿ç”¨æŒ‡å—

### è¿è¡Œæ­¥éª¤ï¼ˆå‘½ä»¤è¡Œï¼‰
1. å‡†å¤‡ä¸€ä¸ª PPT æ–‡ä»¶ï¼ˆå¦‚ `sample.pptx` æˆ– `sample.ppt`ï¼‰ã€‚
2. åœ¨ `config.py` ä¸­è®¾ç½® `PPTX_FILE_2` ä¸ºä½ çš„æ–‡ä»¶è·¯å¾„ã€‚
3. è¿è¡Œï¼š
```bash
python main.py
```
4. æŸ¥çœ‹ `output/optimized_output.txt` ä¸­çš„ç»“æœã€‚

### è¿è¡Œæ­¥éª¤ï¼ˆWebï¼‰
1. è¿è¡Œ Web æœåŠ¡ï¼š
```bash
python app.py
```
2. è®¿é—® `http://localhost:5000/`ï¼Œä¸Šä¼  PPT æ–‡ä»¶ã€‚
3. æŸ¥çœ‹è¿”å›çš„ä¼˜åŒ–æ–‡æœ¬æˆ– `output/optimized_output_*.txt`ã€‚

### è‡ªå®šä¹‰è¾“å‡º
- ä¿®æ”¹ `ai_optimizer.py` è°ƒæ•´æ–‡æœ¬ä¼˜åŒ–é€»è¾‘ã€‚
- åœ¨ `config.py` ä¸­æ›´æ”¹ `OUTPUT_DIR_2` è®¾ç½®è¾“å‡ºè·¯å¾„ã€‚

---

## å¸¸è§é—®é¢˜ (FAQ)

1. **æ”¯æŒå“ªäº›æ–‡ä»¶æ ¼å¼ï¼Ÿ**
- æ”¯æŒ `.pptx`ã€`.pptm`ã€`.potx`ã€`.ppsx`ï¼ˆä½¿ç”¨ `python-pptx`ï¼‰ã€‚
- æ”¯æŒ `.ppt`ã€`.pot`ã€`.pps`ï¼ˆä½¿ç”¨ `pywin32`ï¼Œéœ€ Windows å’Œ PowerPointï¼‰ã€‚
- `.pdf` æš‚æœªå®Œå…¨æ”¯æŒï¼Œå¯åç»­æ‰©å±•ã€‚

2. **å›¾ç‰‡æ–‡æœ¬è¯†åˆ«ä¸å‡†ç¡®æ€ä¹ˆåŠï¼Ÿ**
- ç¡®ä¿å›¾ç‰‡æ¸…æ™°ï¼Œè°ƒæ•´ PaddleOCR çš„ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆ`process_image_for_ocr`ï¼‰ã€‚

3. **å¤„ç†é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ**
- å¯ç”¨ GPUï¼ˆå®‰è£… `paddlepaddle-gpu`ï¼‰ã€‚
- å‡å°‘å¹»ç¯ç‰‡ä¸­çš„å›¾ç‰‡æ•°é‡ã€‚

4. **ä¾èµ–å®‰è£…å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
- æ£€æŸ¥ç½‘ç»œï¼Œè¿è¡Œ `pip install --upgrade pip`ã€‚
- ç¡®ä¿ Python ç‰ˆæœ¬ >= 3.8ï¼ŒProtobuf ç‰ˆæœ¬ä¸º 3.20.3ã€‚

---

## è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](https://opensource.org/licenses/MIT)ï¼Œæ¬¢è¿ä½¿ç”¨å’Œä¿®æ”¹ã€‚

---

## è´¡çŒ®æŒ‡å—
æ¬¢è¿è´¡çŒ®ä»£ç æˆ–å»ºè®®ï¼
- **æŠ¥å‘Šé—®é¢˜**ï¼šæäº¤ GitHub Issueã€‚
- **æäº¤ä»£ç **ï¼šFork ä»“åº“å¹¶åˆ›å»º Pull Requestã€‚
- **è§„èŒƒ**ï¼šéµå¾ª PEP 8ï¼Œæ·»åŠ æ³¨é‡Šã€‚

### è´¡çŒ®æµç¨‹
1. Fork ä»“åº“ã€‚
2. åˆ›å»ºåˆ†æ”¯ï¼ˆ`git checkout -b feature/xxx`ï¼‰ã€‚
3. æäº¤æ›´æ”¹ï¼ˆ`git commit -m "æè¿°"`ï¼‰ã€‚
4. Push åˆ°è¿œç¨‹ï¼ˆ`git push origin feature/xxx`ï¼‰ã€‚
5. åˆ›å»º Pull Requestã€‚

---

## è”ç³»æ–¹å¼
- **é‚®ç®±**ï¼šzhanghoubing777@gmail.com
- **GitHub**ï¼šhttps://github.com/BlairCode